<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Elegoo Car Simulator</title>
<style>
  #car {
    position: relative;
    width: 50px;
    height: 100px;
    background-color: blue;
    transition: all 0.5s ease; /* This provides a basic animation effect */
  }
</style>
</head>
<body>

<div id="car"></div>

<label for="command">Command:</label>
<select id="command">
  <option value="forward">Forward</option>
  <option value="backward">Backward</option>
  <option value="left">Left</option>
  <option value="right">Right</option>
</select>

<label for="duration">Duration (ms):</label>
<input type="number" id="duration" value="1000" />

<label for="speed">Speed (0-255):</label>
<input type="number" id="speed" value="255" />

<button onclick="runCommand()">Run Command</button>

<script>
const carElement = document.getElementById('car');

// We'll use a timeout to ensure commands run one after another
let lastTimeout = null;

function moveCar(direction, duration, speed) {
  clearTimeout(lastTimeout); // Clear the last timeout to reset the command sequence

  const speedFactor = speed / 255; // Speed factor based on max speed 255
  const distance = 10 * speedFactor; // Simple calculation for distance

  switch (direction) {
    case 'forward':
      carElement.style.transform = `translateY(${distance}px)`;
      break;
    case 'backward':
      carElement.style.transform = `translateY(-${distance}px)`;
      break;
    case 'left':
      carElement.style.transform = `translateX(-${distance}px)`;
      break;
    case 'right':
      carElement.style.transform = `translateX(${distance}px)`;
      break;
    default:
      console.log('Invalid direction:', direction);
      return;
  }

  // Set the transition duration based on the speed factor
  carElement.style.transition = `all ${duration/1000}s ease`;
}

function runCommand() {
  const direction = document.getElementById('command').value;
  const duration = parseInt(document.getElementById('duration').value, 10);
  const speed = parseInt(document.getElementById('speed').value, 10);

  moveCar(direction, duration, speed);

  // Set the timeout to prevent a new command from starting
  lastTimeout = setTimeout(() => {
    carElement.style.transform = ''; // Reset the transform after the duration
    carElement.style.transition = '';
  }, duration);
}
</script>

</body>
</html>
